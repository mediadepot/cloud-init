{
  "ignition": {
    "config": {},
    "security": {
      "tls": {}
    },
    "timeouts": {},
    "version": "2.2.0"
  },
  "networkd": {},
  "passwd": {},
  "storage": {
    "directories": [
      {
        "filesystem": "root",
        "path": "/opt/mediadepot/authelia/data",
        "mode": 493
      }
    ],
    "files": [
      {
        "filesystem": "root",
        "path": "/opt/mediadepot/systemd/authelia/docker-compose.yml",
        "contents": {
          "source": "data:,version%3A%20'2'%0Aservices%3A%0A%20%20authelia%3A%0A%20%20%20%20image%3A%20authelia%2Fauthelia%0A%20%20%20%20volumes%3A%0A%20%20%20%20%20%20-%20'%2Fopt%2Fmediadepot%2Fauthelia%2Fconfiguration.yml%3A%2Fconfig%2Fconfiguration.yml%3Aro'%0A%20%20%20%20%20%20-%20'%2Fopt%2Fmediadepot%2Fauthelia%2Fdata%3A%2Fetc%2Fauthelia%2Fdata%3Arw'%0A%20%20%20%20environment%3A%0A%20%20%20%20%20%20-%20'TZ%3DAmerica%2FLos_Angeles'%0A%20%20%20%20labels%3A%0A%20%20%20%20%20%20-%20'traefik.enable%3Dtrue'%0A%20%20%20%20%20%20-%20'traefik.http.services.authelia.loadbalancer.server.port%3D9091'%0A%20%20%20%20%20%20-%20'traefik.http.routers.authelia.rule%3DHost(%60login.%24%7BDEPOT_DOMAIN_NAME%7D%60)'%0A%20%20%20%20%20%20-%20'traefik.http.routers.authelia.entrypoints%3Dwebsecure'%0A%20%20%20%20%20%20-%20'traefik.http.routers.authelia.tls.certresolver%3Dmydnschallenge'%0A%20%20%20%20networks%3A%0A%20%20%20%20%20%20-%20traefik%0Anetworks%3A%0A%20%20traefik%3A%0A%20%20%20%20external%3A%20true",
          "verification": {}
        },
        "mode": 493
      },
      {
        "filesystem": "root",
        "path": "/opt/mediadepot/authelia/configuration.yml",
        "contents": {
          "source": "data:,%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Authelia%20configuration%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%0A%23%20The%20host%20and%20port%20to%20listen%20on%0Ahost%3A%200.0.0.0%0Aport%3A%209091%0A%0A%23%20Level%20of%20verbosity%20for%20logs%3A%20info%2C%20debug%2C%20trace%0Alog_level%3A%20info%0A%0A%23%20The%20secret%20used%20to%20generate%20JWT%20tokens%20when%20validating%20user%20identity%20by%0A%23%20email%20confirmation.%0Ajwt_secret%3A%20change_this_secret%0A%0A%23%20Default%20redirection%20URL%0A%23%0A%23%20If%20user%20tries%20to%20authenticate%20without%20any%20referer%2C%20Authelia%0A%23%20does%20not%20know%20where%20to%20redirect%20the%20user%20to%20at%20the%20end%20of%20the%0A%23%20authentication%20process.%0A%23%20This%20parameter%20allows%20you%20to%20specify%20the%20default%20redirection%0A%23%20URL%20Authelia%20will%20use%20in%20such%20a%20case.%0A%23%0A%23%20Note%3A%20this%20parameter%20is%20optional.%20If%20not%20provided%2C%20user%20won't%0A%23%20be%20redirected%20upon%20successful%20authentication.%0Adefault_redirection_url%3A%20http%3A%2F%2Fhome.depot.lan%2F%0A%0A%23%20TOTP%20Issuer%20Name%0A%23%0A%23%20This%20will%20be%20the%20issuer%20name%20displayed%20in%20Google%20Authenticator%0A%23%20See%3A%20https%3A%2F%2Fgithub.com%2Fgoogle%2Fgoogle-authenticator%2Fwiki%2FKey-Uri-Format%20for%20more%20info%20on%20issuer%20names%0Atotp%3A%0A%20%20issuer%3A%20authelia.com%0A%0A%23%20Duo%20Push%20API%0A%23%0A%23%20Parameters%20used%20to%20contact%20the%20Duo%20API.%20Those%20are%20generated%20when%20you%20protect%20an%20application%0A%23%20of%20type%20%22Partner%20Auth%20API%22%20in%20the%20management%20panel.%0A%23%20duo_api%3A%0A%23%20%20%20hostname%3A%20api-123456789.example.com%0A%23%20%20%20integration_key%3A%20ABCDEF%0A%23%20%20%20secret_key%3A%201234567890abcdefghifjkl%0A%0A%23%20The%20authentication%20backend%20to%20use%20for%20verifying%20user%20passwords%0A%23%20and%20retrieve%20information%20such%20as%20email%20address%20and%20groups%0A%23%20users%20belong%20to.%0A%23%0A%23%20There%20are%20two%20supported%20backends%3A%20%60ldap%60%20and%20%60file%60.%0Aauthentication_backend%3A%0A%0A%20%20%23%20File%20backend%20configuration.%0A%20%20%23%0A%20%20%23%20With%20this%20backend%2C%20the%20users%20database%20is%20stored%20in%20a%20file%0A%20%20%23%20which%20is%20updated%20when%20users%20reset%20their%20passwords.%0A%20%20%23%20Therefore%2C%20this%20backend%20is%20meant%20to%20be%20used%20in%20a%20dev%20environment%0A%20%20%23%20and%20not%20in%20production%20since%20it%20prevents%20Authelia%20to%20be%20scaled%20to%0A%20%20%23%20more%20than%20one%20instance.%0A%20%20%23%0A%20%20file%3A%0A%20%20%20%20path%3A%20%2Fetc%2Fauthelia%2Fdata%2Fusers_database.yml%0A%0A%23%20Access%20Control%0A%23%0A%23%20Access%20control%20is%20a%20list%20of%20rules%20defining%20the%20authorizations%20applied%20for%20one%0A%23%20resource%20to%20users%20or%20group%20of%20users.%0A%23%0A%23%20If%20'access_control'%20is%20not%20defined%2C%20ACL%20rules%20are%20disabled%20and%20the%20%60bypass%60%0A%23%20rule%20is%20applied%2C%20i.e.%2C%20access%20is%20allowed%20to%20anyone.%20Otherwise%20restrictions%20follow%0A%23%20the%20rules%20defined.%0A%23%0A%23%20Note%3A%20One%20can%20use%20the%20wildcard%20*%20to%20match%20any%20subdomain.%0A%23%20It%20must%20stand%20at%20the%20beginning%20of%20the%20pattern.%20(example%3A%20*.mydomain.com)%0A%23%0A%23%20Note%3A%20You%20must%20put%20patterns%20containing%20wildcards%20between%20simple%20quotes%20for%20the%20YAML%0A%23%20to%20be%20syntactically%20correct.%0A%23%0A%23%20Definition%3A%20A%20%60rule%60%20is%20an%20object%20with%20the%20following%20keys%3A%20%60domain%60%2C%20%60subject%60%2C%0A%23%20%60policy%60%20and%20%60resources%60.%0A%23%0A%23%20-%20%60domain%60%20defines%20which%20domain%20or%20set%20of%20domains%20the%20rule%20applies%20to.%0A%23%0A%23%20-%20%60subject%60%20defines%20the%20subject%20to%20apply%20authorizations%20to.%20This%20parameter%20is%0A%23%20%20%20%20optional%20and%20matching%20any%20user%20if%20not%20provided.%20If%20provided%2C%20the%20parameter%0A%23%20%20%20%20represents%20either%20a%20user%20or%20a%20group.%20It%20should%20be%20of%20the%20form%20'user%3A%3Cusername%3E'%0A%23%20%20%20%20or%20'group%3A%3Cgroupname%3E'.%0A%23%0A%23%20-%20%60policy%60%20is%20the%20policy%20to%20apply%20to%20resources.%20It%20must%20be%20either%20%60bypass%60%2C%0A%23%20%20%20%60one_factor%60%2C%20%60two_factor%60%20or%20%60deny%60.%0A%23%0A%23%20-%20%60resources%60%20is%20a%20list%20of%20regular%20expressions%20that%20matches%20a%20set%20of%20resources%20to%0A%23%20%20%20%20apply%20the%20policy%20to.%20This%20parameter%20is%20optional%20and%20matches%20any%20resource%20if%20not%0A%23%20%20%20%20provided.%0A%23%0A%23%20Note%3A%20the%20order%20of%20the%20rules%20is%20important.%20The%20first%20policy%20matching%0A%23%20(domain%2C%20resource%2C%20subject)%20applies.%0Aaccess_control%3A%0A%20%20%23%20Default%20policy%20can%20either%20be%20%60bypass%60%2C%20%60one_factor%60%2C%20%60two_factor%60%20or%20%60deny%60.%0A%20%20%23%20It%20is%20the%20policy%20applied%20to%20any%20resource%20if%20there%20is%20no%20policy%20to%20be%20applied%0A%20%20%23%20to%20the%20user.%0A%20%20default_policy%3A%20deny%0A%0A%20%20rules%3A%0A%20%20%20%20%23%20Rules%20applied%20to%20everyone%0A%20%20%20%20-%20domain%3A%20home.depot.lan%0A%20%20%20%20%20%20policy%3A%20bypass%0A%0A%20%20%20%20-%20domain%3A%20%22*.depot.lan%22%0A%20%20%20%20%20%20policy%3A%20one_factor%0A%0A%23%20Configuration%20of%20session%20cookies%0A%23%0A%23%20The%20session%20cookies%20identify%20the%20user%20once%20logged%20in.%0Asession%3A%0A%20%20%23%20The%20name%20of%20the%20session%20cookie.%20(default%3A%20authelia_session).%0A%20%20name%3A%20authelia_session%0A%0A%20%20%23%20The%20secret%20to%20encrypt%20the%20session%20cookie.%0A%20%20secret%3A%20change_this_secret%0A%0A%20%20%23%20The%20time%20in%20seconds%20before%20the%20cookie%20expires%20and%20session%20is%20reset.%0A%20%20expiration%3A%203600%20%23%201%20hour%0A%0A%20%20%23%20The%20inactivity%20time%20in%20seconds%20before%20the%20session%20is%20reset.%0A%20%20inactivity%3A%20300%20%23%205%20minutes%0A%0A%20%20%23%20The%20domain%20to%20protect.%0A%20%20%23%20Note%3A%20the%20authenticator%20must%20also%20be%20in%20that%20domain.%20If%20empty%2C%20the%20cookie%0A%20%20%23%20is%20restricted%20to%20the%20subdomain%20of%20the%20issuer.%0A%20%20domain%3A%20depot.lan%0A%0A%23%20Configuration%20of%20the%20authentication%20regulation%20mechanism.%0A%23%0A%23%20This%20mechanism%20prevents%20attackers%20from%20brute%20forcing%20the%20first%20factor.%0A%23%20It%20bans%20the%20user%20if%20too%20many%20attempts%20are%20done%20in%20a%20short%20period%20of%0A%23%20time.%0Aregulation%3A%0A%20%20%23%20The%20number%20of%20failed%20login%20attempts%20before%20user%20is%20banned.%0A%20%20%23%20Set%20it%20to%200%20to%20disable%20regulation.%0A%20%20max_retries%3A%203%0A%0A%20%20%23%20The%20time%20range%20during%20which%20the%20user%20can%20attempt%20login%20before%20being%20banned.%0A%20%20%23%20The%20user%20is%20banned%20if%20the%20authentication%20failed%20%60max_retries%60%20times%20in%20a%20%60find_time%60%20seconds%20window.%0A%20%20find_time%3A%20120%0A%0A%20%20%23%20The%20length%20of%20time%20before%20a%20banned%20user%20can%20login%20again.%0A%20%20ban_time%3A%20300%0A%0A%23%20Configuration%20of%20the%20storage%20backend%20used%20to%20store%20data%20and%20secrets.%0A%23%0A%23%20You%20must%20use%20only%20an%20available%20configuration%3A%20local%2C%20sql%0Astorage%3A%0A%20%20%23%20The%20directory%20where%20the%20DB%20files%20will%20be%20saved%0A%20%20local%3A%0A%20%20%20%20path%3A%20%2Fetc%2Fauthelia%2Fdata%2Fdb.sqlite3%0A%0A%23%20Configuration%20of%20the%20notification%20system.%0A%23%0A%23%20Notifications%20are%20sent%20to%20users%20when%20they%20require%20a%20password%20reset%2C%20a%20u2f%0A%23%20registration%20or%20a%20TOTP%20registration.%0A%23%20Use%20only%20an%20available%20configuration%3A%20filesystem%2C%20gmail%0Anotifier%3A%0A%20%20%23%20For%20testing%20purpose%2C%20notifications%20can%20be%20sent%20in%20a%20file%0A%20%20filesystem%3A%0A%20%20%20%20filename%3A%20%2Fetc%2Fauthelia%2Fdata%2Fnotification.txt%0A%0A%20%20%23%20Sending%20an%20email%20using%20a%20Gmail%20account%20is%20as%20simple%20as%20the%20next%20section.%0A%20%20%23%20You%20need%20to%20create%20an%20app%20password%20by%20following%3A%20https%3A%2F%2Fsupport.google.com%2Faccounts%2Fanswer%2F185833%3Fhl%3Den%0A%20%20%23%23%20smtp%3A%0A%20%20%23%23%20%20%20username%3A%20myaccount%40gmail.com%0A%20%20%23%23%20%20%20password%3A%20yourapppassword%0A%20%20%23%23%20%20%20sender%3A%20admin%40example.com%0A%20%20%23%23%20%20%20host%3A%20smtp.gmail.com%0A%20%20%23%23%20%20%20port%3A%20587",
          "verification": {}
        },
        "mode": 493
      }
    ]
  },
  "systemd": {
    "units": [
      {
        "contents": "[Unit]\nDescription=Authelia SSO Auth Container\nAfter=docker.service depot-env.service\nRequires=docker.service depot-env.service\n\n[Service]\nRestart=always\nEnvironmentFile=-/etc/sysconfig/mediadepot\nTimeoutStartSec=0\nRestart=always\nWorkingDirectory=/opt/mediadepot/systemd/authelia/\nExecStartPre=-/usr/bin/docker-compose down -v\nExecStartPre=-/usr/bin/docker-compose rm -v\nExecStartPre=-/usr/bin/docker-compose pull\nExecStart=/usr/bin/docker-compose up\nExecStop=/usr/bin/docker-compose down -v\n\n[Install]\nWantedBy=multi-user.target\nWantedBy=docker.service",
        "enabled": true,
        "name": "authelia.service"
      }
    ]
  }
}
