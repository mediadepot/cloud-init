{
  "ignition": {
    "config": {},
    "timeouts": {},
    "version": "2.2.0"
  },
  "networkd": {},
  "passwd": {
    "users": [
      {
        "name": "core",
        "sshAuthorizedKeys": [
          "ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAIEA0QIsn450XjpKdoAicWqu6pgoc7h+lUokibTF75NcLVhrhnOn8aVpV+MemlE6kt6wjZDK7WyTEX1+/4dIFwH92+TJwBRKG8Yd0aTFHjWZg7K/dZAak041sF21D9K+7R0PtZK/B6szbdN9bZtwss2ebuzMu9Pxw3Rzq/PsPfl9nzs="
        ]
      },
      {
        "name": "depot",
        "uid": 15000,
        "primaryGroup": "depot",
        "noUserGroup": true,
        "system": false,
        "sshAuthorizedKeys": [
          "ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAIEA0QIsn450XjpKdoAicWqu6pgoc7h+lUokibTF75NcLVhrhnOn8aVpV+MemlE6kt6wjZDK7WyTEX1+/4dIFwH92+TJwBRKG8Yd0aTFHjWZg7K/dZAak041sF21D9K+7R0PtZK/B6szbdN9bZtwss2ebuzMu9Pxw3Rzq/PsPfl9nzs="
        ],
        "shell": "/bin/bash"

      }
    ],
    "groups": [
      {
        "name": "depot",
        "gid": 15000,
        "system": false
      }
    ]
  },
  "storage": {
    "files": [
      {
        "filesystem": "root",
        "path": "/opt/sbin/mergerfs",
        "mode": 493,
        "contents": { "source": "https://mediadepot.github.io/ignition/files/sbin/mergerfs" }
      },
      {
        "filesystem": "root",
        "path": "/opt/mediadepot/filesystem.sh",
        "mode": 493,
        "contents": { "source": "https://mediadepot.github.io/ignition/files/filesystem.sh" }
      }
    ],
    "links": [
      {
        "filesystem": "root",
        "path": "/opt/sbin/mount.mergerfs",
        "target": "/opt/sbin/mergerfs"
      }
    ],
    "directories": [
      {
        "filesystem": "root",
        "mode": 493,
        "path": "/opt/sbin/"
      },
      {
        "filesystem": "root",
        "mode": 493,
        "path": "/opt/sbin.workdir/"
      },

      {
        "filesystem": "root",
        "mode": 493,
        "path": "/opt/mediadepot/rancher/"
      },

      {
        "filesystem": "root",
        "mode": 493,
        "path": "/opt/mediadepot/apps/",
        "user": {
          "id": 15000
        },
        "group": {
          "id": 15000
        }
      },

      {
        "filesystem": "root",
        "mode": 493,
        "path": "/media/storage/",
        "user": {
          "id": 15000
        },
        "group": {
          "id": 15000
        }
      },
      {
        "filesystem": "root",
        "mode": 493,
        "path": "/media/temp/",
        "user": {
          "id": 15000
        },
        "group": {
          "id": 15000
        }
      },
      {
        "filesystem": "root",
        "mode": 493,
        "path": "/mnt/drive1/",
        "user": {
          "id": 15000
        },
        "group": {
          "id": 15000
        }
      }
    ]
  },
  "systemd": {
    "units": [
      {
        "name":"overlay-sbin.mount",
        "enabled": true,
        "contents": "[Unit]\nDescription=Overlay mount /usr/sbin mount\nBefore=local-fs.target\nConditionPathExists=/opt/sbin\n\n[Mount]\nType=overlay\nWhat=overlay\nWhere=/usr/sbin\nOptions=lowerdir=/usr/sbin,upperdir=/opt/sbin,workdir=/opt/sbin.workdir\n\n[Install]\nWantedBy=local-fs.target"
      },


      {
        "name": "rancher.service",
        "enabled": true,
        "contents": "[Unit]\nDescription=Rancher Admin Container\nAfter=docker.service\nRequires=docker.service\n\n[Service]\nTimeoutStartSec=0\nRestart=always\nExecStartPre=-/usr/bin/docker kill %n\nExecStartPre=-/usr/bin/docker rm %n\nExecStartPre=-/usr/bin/docker pull rancher/rancher:stable\nExecStart=/usr/bin/docker run --rm --name %n -p 80:80 -p 443:443 -v /opt/mediadepot/rancher:/var/lib/rancher rancher/rancher:stable\nExecStop=/usr/bin/docker stop -t 15 %n\n\n\n[Install]\nWantedBy=multi-user.target"
      }
    ]
  }
}